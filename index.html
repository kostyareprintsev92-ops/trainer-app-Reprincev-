<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç—Ä–µ–Ω–µ—Ä–∞</title>
  <style>
    :root { --bg:#f6f6f6; --card:#fff; --txt:#111; --muted:#666; --accent:#000; }
    *{box-sizing:border-box;}
    body{margin:0; background:var(--bg); color:var(--txt); font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;}
    .wrap{max-width:900px; margin:20px auto; padding:0 16px;}
    .bar{position:sticky; top:0; z-index:10; background:rgba(255,255,255,.9); border-bottom:1px solid #e9e9e9; backdrop-filter:saturate(180%) blur(10px)}
    .bar-in{max-width:900px; margin:0 auto; padding:14px 16px;}
    h1{font-size:22px; margin:0; font-weight:800;}
    .card{background:var(--card); border:1px solid #e9e9e9; border-radius:14px; padding:18px; box-shadow:0 1px 3px rgba(0,0,0,.04)}
    .ttl{font-weight:800; font-size:18px; margin-bottom:12px}
    label{display:block; font-size:13px; color:#666; margin:10px 0 6px}
    input, select, textarea{
      width:100%; padding:12px 14px; border:1px solid #ddd; border-radius:10px; font-size:16px; background:#fff;
    }
    textarea{min-height:90px; resize:vertical}
    .row{display:grid; gap:12px; grid-template-columns:1fr}
    @media(min-width:640px){ .row{ grid-template-columns:1fr 1fr } }
    .btn{display:block; width:100%; margin-top:14px; padding:14px 18px; border-radius:12px; border:0; background:#111; color:#fff; font-weight:800; font-size:16px; cursor:pointer}
    .btn:disabled{opacity:.5; cursor:not-allowed}
    #msg{display:none; padding:10px 12px; border-radius:10px; margin-top:10px; font-size:14px}
    .ok{background:#e8f7ee; color:#0b7a3b; border:1px solid #bfe7cf}
    .err{background:#fdeaea; color:#a11; border:1px solid #f6caca}
    footer{margin:32px auto; color:#888; font-size:13px; text-align:center}
  </style>
</head>
<body>
  <div class="bar">
    <div class="bar-in">
      <h1>–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç—Ä–µ–Ω–µ—Ä–∞</h1>
    </div>
  </div>

  <div class="wrap">
    <div class="card">
      <div class="ttl">–ó–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É</div>
      <p style="margin:0 0 14px;color:#666">–û—Å—Ç–∞–≤—å—Ç–µ –¥–∞–Ω–Ω—ã–µ ‚Äî —è –ø–æ–¥—Ç–≤–µ—Ä–∂—É –∑–∞–ø–∏—Å—å –∏ —Å–≤—è–∂—É—Å—å —Å –≤–∞–º–∏.</p>

      <form id="form">
        <label for="name">–ò–º—è</label>
        <input id="name" name="name" placeholder="–ò–≤–∞–Ω" required />

        <label for="phone">–¢–µ–ª–µ—Ñ–æ–Ω</label>
        <input id="phone" name="phone" inputmode="tel" placeholder="+7 999 123-45-67" required />

        <div class="row">
          <div>
            <label for="date">–î–∞—Ç–∞</label>
            <input id="date" name="date" type="date" required />
          </div>
          <div>
            <label for="time">–í—Ä–µ–º—è</label>
            <select id="time" name="time" required>
              <option value="" disabled selected>–í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è</option>
              <option>08:00</option><option>09:00</option><option>10:00</option>
              <option>11:00</option><option>12:00</option><option>13:00</option>
              <option>14:00</option><option>15:00</option><option>16:00</option>
              <option>17:00</option><option>18:00</option><option>19:00</option>
              <option>20:00</option>
            </select>
          </div>
        </div>

        <label for="comment">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
        <textarea id="comment" name="comment" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ø–µ—Ä–≤–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ / –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é –∑–≤–æ–Ω–æ–∫"></textarea>

        <button class="btn" id="submitBtn" type="submit">–ó–∞–ø–∏—Å–∞—Ç—å—Å—è</button>
        <div id="msg"></div>
      </form>
    </div>

    <footer>–°–¥–µ–ª–∞–Ω–æ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∑–∞–ø–∏—Å–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤. –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ Cloud Firestore.</footer>
  </div>

  <!-- Firebase (–º–æ–¥—É–ª—å–Ω—ã–π SDK —á–µ—Ä–µ–∑ CDN) -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    // üîë –¢–í–û–ò –∫–ª—é—á–∏ (–∑–∞–º–µ–Ω–∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –Ω–∞ —Å–≤–æ–∏)
    const firebaseConfig = {
      apiKey: "AIzaSyA3XwM-qceM1_uMuK7NpTa7RKQyAyQw1Ws",
      authDomain: "reprincev-b73c7.firebaseapp.com",
      projectId: "reprincev-b73c7",
      storageBucket: "reprincev-b73c7.firebasestorage.app",
      messagingSenderId: "616952094737",
      appId: "1:616952094737:web:82f22ef07d9f13309911b0",
      measurementId: "G-8WFHS344GZ"
    };

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    const app = initializeApp(firebaseConfig);
    const db  = getFirestore(app);

    // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–π –¥–∞—Ç—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    const dateInput = document.getElementById('date');
    const today = new Date();
    const yyyy = today.getFullYear();
    const mm = String(today.getMonth()+1).padStart(2,'0');
    const dd = String(today.getDate()).padStart(2,'0');
    dateInput.value = `${yyyy}-${mm}-${dd}`;

    // –†–∞–±–æ—Ç–∞ —Ñ–æ—Ä–º—ã
    const form = document.getElementById('form');
    const btn  = document.getElementById('submitBtn');
    const msg  = document.getElementById('msg');

    function showMsg(text, ok=true){
      msg.textContent = text;
      msg.className = ok ? 'ok' : 'err';
      msg.id = 'msg';
      msg.style.display = 'block';
    }

    form.addEventListener('submit', async (e)=>{
      e.preventDefault();
      btn.disabled = true;

      const name    = document.getElementById('name').value.trim();
      const phone   = document.getElementById('phone').value.trim();
      const date    = document.getElementById('date').value;
      const time    = document.getElementById('time').value;
      const comment = document.getElementById('comment').value.trim();

      if(!name || !phone || !date || !time){
        showMsg('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è.', false);
        btn.disabled = false;
        return;
      }

      try{
        await addDoc(collection(db, 'requests'), {
          name, phone, date, time, comment,
          createdAt: serverTimestamp(),
          status: 'new' // –Ω–∞ –±—É–¥—É—â–µ–µ: new / confirmed / done
        });

        showMsg('–ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞! –Ø —Å–≤—è–∂—É—Å—å —Å –≤–∞–º–∏ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è ‚úÖ', true);
        form.reset();
        dateInput.value = `${yyyy}-${mm}-${dd}`;
      }catch(err){
        console.error(err);
        showMsg('–ù–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.', false);
      }finally{
        btn.disabled = false;
      }
    });
  </script>
</body>
</html>
